(this["webpackJsonpvideo-calling-web-app"]=this["webpackJsonpvideo-calling-web-app"]||[]).push([[0],{10:function(e,n,o){},11:function(e,n,o){},13:function(e,n,o){"use strict";o.r(n);var t,i=o(2),c=o.n(i),l=o(5),s=o.n(l),a=(o(10),o(11),o(3)),d=o.n(a),r=o(1),u=o.n(r),m=o(0),b={client:null,joined:!1,published:!1,localStream:null,remoteStreams:[],params:{},localAudioTrack:null},f="a86a315fcd594277ac1ffb6cd6990fed",v="video-calling",g=null,h="",j="480_4";function p(e){b.client=d.a.createClient({mode:"live",codec:"h264"}),b.client.init(f,(function(){console.log("init success"),function(){var e=null,n=null;b.client.join(e,null,n,(function(e){console.log("User "+e+" join channel successfully"),function(e){var n=d.a.createStream({streamID:e,audio:!0,video:!0,screen:!1});n.setVideoProfile(j),n.init((function(){console.log("getUserMedia successfully"),n.play("local-video"),b.client.publish(n,(function(e){console.log("[ERROR] : publish local stream error: "+e)})),function(e){u()("#mic-btn").prop("disabled",!1),u()("#video-btn").prop("disabled",!1),u()("#mic-btn").click((function(){!function(e){x(u()("#mic-btn")),u()("#mic-icon").toggleClass("fa-microphone").toggleClass("fa-microphone-slash"),u()("#mic-icon").hasClass("fa-microphone")?(e.enableAudio(),O("#mute-overlay",!1)):(e.disableAudio(),O("#mute-overlay",!0))}(e)})),u()("#video-btn").click((function(){!function(e){x(u()("#video-btn")),u()("#video-icon").toggleClass("fa-video").toggleClass("fa-video-slash"),u()("#video-icon").hasClass("fa-video")?(e.enableVideo(),O("#no-local-video",!1)):(e.disableVideo(),O("#no-local-video",!0))}(e)}))}(n),b.localStreams.camera.stream=n}),(function(e){console.log("[ERROR] : getUserMedia failed",e)}))}(e),b.localStreams.camera.id=e}),(function(e){console.log("[ERROR] : join channel failed",e)}))}(),b.client.join(h||null,v,g?+g:null,(function(n){console.log("join channel: "+v+" success, uid: "+n),b.params.uid=n,"host"===e&&(document.getElementById("remote_video_").disabled=!0,b.client.setClientRole("host"),b.localStream=d.a.createStream({streamID:b.params.uid,audio:!0,video:!0}),b.localStream.init((function(){console.log("init local stream success"),b.localStream.play("local_stream"),b.client.publish(b.localStream,(function(e){console.log("publish failed"),console.error(e)}))}),(function(e){console.error("init local stream failed ",e)})),b.client.on("connection-state-change",(function(e){console.log("audience",e)}))),"audience"===e&&(document.getElementById("local_stream").disabled=!0,b.client.on("connection-state-change",(function(e){console.log("audience",e)})),b.client.on("stream-added",(function(e){var n=e.stream,o=n.getId();o!==b.params.uid&&b.client.subscribe(n,(function(e){console.log("stream subscribe failed",e)})),console.log("stream-added remote-uid: ",o)})),b.client.on("stream-removed",(function(e){var n=e.stream.getId();console.log("stream-removed remote-uid: ",n)})),b.client.on("stream-subscribed",(function(e){var n=e.stream,o=n.getId();t=o,n.play("remote_video_",{muted:!0}),console.log("stream-subscribed remote-uid: ",o)})),b.client.on("mute-audio",(function(e){O("#"+e.uid+"_mute",!0)})),b.client.on("unmute-audio",(function(e){O("#"+e.uid+"_mute",!1)})),b.client.on("mute-video",(function(e){var n=e.uid;n!==t&&O("#"+n+"_no-video",!0)})),b.client.on("unmute-video",(function(e){O("#"+e.uid+"_no-video",!1)})),b.client.on("stream-unsubscribed",(function(e){var n=e.stream,o=n.getId();n.pause("remote_video_"),console.log("stream-unsubscribed remote-uid: ",o)})))}),(function(e){console.error("client join failed",e)}))}),(function(e){console.error(e)}))}function x(e){e.toggleClass("btn-dark").toggleClass("btn-danger")}function O(e,n){n?u()(e).attr("style","display:block"):u()(e).attr("style","display:none")}u()("#mic-btn").prop("disabled",!0),u()("#video-btn").prop("disabled",!0);var y=function(e){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("button",{className:"btn my-2",onClick:function(){return p("host")},children:"Join Channel as Host"}),Object(m.jsx)("button",{className:"btn",onClick:function(){return p("audience")},children:"Join Channel as Audience"}),Object(m.jsx)("button",{className:"btn",onClick:function(){return b.client.unpublish(b.localStream,(function(e){console.log("publish failed"),alert("You left the meeting as Host"),console.error(e)})),void b.client.leave((function(e){console.log(e)}))},children:"Leave Event Host"}),Object(m.jsx)("button",{className:"btn",onClick:function(){b.client.leave((function(){console.log("client leaves channel"),alert("Left the meeting as an audience")}),(function(e){console.log("client leave failed ",e)}))},children:"Leave Event Audience"})]}),Object(m.jsx)("div",{class:"container",children:Object(m.jsxs)("div",{class:"row",children:[Object(m.jsx)("div",{class:"col-sm",children:Object(m.jsx)("button",{id:"mic-btn",type:"button",class:"btn btn-block btn-dark btn-lg",children:Object(m.jsx)("i",{id:"mic-icon",class:"fas fa-microphone"})})}),Object(m.jsx)("div",{class:"col-sm",children:Object(m.jsx)("button",{id:"video-btn",type:"button",class:"btn btn-block btn-dark btn-lg",children:Object(m.jsx)("i",{id:"video-icon",class:"fas fa-video"})})})]})}),Object(m.jsx)("div",{class:"container",children:Object(m.jsxs)("div",{class:"row",children:[Object(m.jsx)("div",{class:"col-sm",children:Object(m.jsx)("div",{id:"local_stream",className:"local_stream",style:{width:"100%",height:"100vh",display:"flex"}})}),Object(m.jsx)("div",{class:"col-sm",children:Object(m.jsx)("div",{id:"remote_video_",style:{margin:"0px",width:"100%",height:"100vh",display:"flex"}})})]})})]})};var C=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(y,{})})},_=function(e){e&&e instanceof Function&&o.e(3).then(o.bind(null,14)).then((function(n){var o=n.getCLS,t=n.getFID,i=n.getFCP,c=n.getLCP,l=n.getTTFB;o(e),t(e),i(e),c(e),l(e)}))};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(C,{})}),document.getElementById("root")),_()}},[[13,1,2]]]);
//# sourceMappingURL=main.2047003f.chunk.js.map